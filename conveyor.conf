// 手工维护的 Conveyor 配置文件。
//
// 自动生成的 Gradle/Compose/JDK/inputs 片段通过 Gradle 任务动态提取（适合 CI）。
// 也可以用 `./gradlew writeConveyorConfig` 生成一个 `generated.conveyor.conf` 供排查问题用，
// 但不建议把它提交进仓库（里面全是绝对路径）。

// CI 里建议先用 setup-java 固定到 JDK 21（项目使用 21 toolchain），避免本机 JDK 过新导致 Gradle/Kotlin DSL 解析失败。
include "#!./gradlew -p composeApp --console=plain --quiet printConveyorConfig"

// 启用 native library 预提取（例如 Skiko），提升启动速度与健壮性。
include file("conveyor/extract-native-libraries.conf")

// 保持与较旧 Conveyor 版本的配置兼容（模板默认值）。
conveyor.compatibility-level = 18

app {
  jvm {
    // https://conveyor.hydraulic.dev/21.0/configs/jvm/#localization
    modules += jdk.localedata
    jlink-flags += "--include-locales=en,zh,jp"
  }

  // 用户可见名称（安装器/菜单显示名）。文件系统名由 `app.fsname` 控制（需为 kebab-case）。
  display-name = "FileFlattener"

  // Conveyor 要求 fsname 必须是 kebab-case（小写字母/数字/连字符），否则会拒绝构建。
  fsname = file-flattener

  // 建议显式写死，避免未来改 `app.fsname` 后 rdns 跟着变化导致断更/断升级。
  rdns-name = "love.forte.tools.file-flattener"

  // GitHub Releases + GitHub Pages（更新站点）。
  vcs-url = github.com/ForteScarlet/file-flattener
  // GitHub Pages 的项目页地址（用于更新检查）。
  site.base-url = "https://fortescarlet.github.io/file-flattener"

  // 图标源文件。Conveyor 会渲染出各平台所需的尺寸与格式。
  icons = icon.svg

  // 如需在应用内从文件系统读取图标，可把渲染结果也一并打包进去（可选，但无副作用）。
  windows.inputs += TASK/rendered-icons/windows
  linux.inputs += TASK/rendered-icons/linux

  // 需要时可打开：每次启动都同步检查更新（不建议默认开启）。
  updates = manual
}
